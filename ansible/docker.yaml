---
- name: This sets up a Docker server
  hosts: ansibleclient1
  remote_user: ec2-user
  become: true
  become_method: sudo
  vars:
      vol: /tmp/myefs/docker_volume
      random_number: "{{ 100 | random }}"
  tasks:
  - name: Installing Docker
    yum:
      name: docker
      state: present
  - name: ensure docker is running
    service:
      name: docker
      state: started
  - name: installing docker image
    shell: docker pull centos
    register: shell_result
  - debug:
      var: shell_result
  - name: Creating test container
    command: "{{ item }}"
    with_items:
    - docker run -itd  --name=test"{{ random_number }}" centos
    - docker run -itd --name=test"{{ random_number }}" -v "{{ vol }}":/tmp  centos
#    shell: docker run -itd -v "{{ vol }}":/tmp  --name=ansibel_vol centos
    register: shell_result
  - debug:
      var: shell_result
